<!DOCTYPE html><html lang="pt-br"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ZYPLAY â€¢ ZYMerge 2048</title>
<style>
  :root{--bg:#050510;--pink:#ff007a;--blue:#00d4ff;--gold:#ffcc00;}
  body{margin:0;background:radial-gradient(900px 500px at 30% -10%, rgba(255,0,122,.18), transparent 60%),
                 radial-gradient(900px 600px at 70% 0%, rgba(0,212,255,.18), transparent 60%),
                 #050510;color:#fff;font-family:system-ui,Arial;text-align:center}
  header{display:flex;gap:10px;justify-content:center;align-items:center;padding:14px;background:rgba(18,18,43,.85);
         border-bottom:3px solid var(--pink);backdrop-filter:blur(10px)}
  a.btn,button.btn{padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.15);background:rgba(0,0,0,.25);
                   color:#fff;cursor:pointer;text-decoration:none;font-weight:800}
  a.btn:hover,button.btn:hover{border-color:rgba(0,212,255,.6)}
  .wrap{max-width:520px;margin:14px auto;padding:0 12px}
  .hud{display:flex;gap:10px;justify-content:space-between;flex-wrap:wrap}
  .pill{flex:1;min-width:160px;display:flex;justify-content:space-between;align-items:center;padding:10px 12px;
        border:1px solid rgba(255,255,255,.12);border-radius:999px;background:rgba(0,0,0,.22);font-weight:900}
  #board{margin:14px auto;width:420px;height:420px;background:rgba(18,18,43,.75);border:2px solid rgba(0,212,255,.45);
         border-radius:18px;display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:10px;
         box-shadow:0 0 40px rgba(0,212,255,.12),0 0 50px rgba(255,0,122,.08)}
  .cell{border-radius:14px;background:rgba(0,0,0,.25);display:flex;align-items:center;justify-content:center;
        font-weight:1000;font-size:28px;user-select:none;position:relative;overflow:hidden}
  .tile{width:100%;height:100%;display:flex;align-items:center;justify-content:center;border-radius:14px;
        transform:scale(1);transition:transform .08s}
  .pop{transform:scale(1.06)}
  .tip{opacity:.85;font-size:13px}
</style></head><body>
<header>
  <a class="btn" href="/">â¬… Voltar ao menu</a>
  <button class="btn" id="soundBtn">ðŸ”Š Som: ON</button>
  <button class="btn" id="newBtn">â†» Novo</button>
</header>

<div class="wrap">
  <div class="hud">
    <div class="pill">Score <span id="score">0</span></div>
    <div class="pill">Melhor <span id="best">0</span></div>
  </div>
  <div id="board"></div>
  <div class="tip">Use <b>setas</b> (ou deslize no celular). Objetivo: chegar no <b>2048</b>.</div>
</div>

<script>
/* ===== SOM ===== */
let audioCtx=null, soundOn=true;
const soundBtn=document.getElementById('soundBtn');
function initAudio(){ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); }
function tone(f=440,d=0.06,type="square",vol=0.045){
  if(!soundOn) return; initAudio();
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.type=type; o.frequency.value=f; g.gain.value=vol;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+d);
}
soundBtn.onclick=()=>{ soundOn=!soundOn; tone(700,0.05); soundBtn.textContent=soundOn?"ðŸ”Š Som: ON":"ðŸ”‡ Som: OFF"; };
document.addEventListener("click", initAudio, {once:true});
document.addEventListener("keydown", initAudio, {once:true});

/* ===== 2048 ===== */
const boardEl=document.getElementById('board');
let grid=[0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0];
let score=0, best=Number(localStorage.getItem("zy_best")||0);
document.getElementById('best').textContent=best;

const colors = (v)=>{
  if(!v) return ["rgba(0,0,0,.25)","rgba(255,255,255,.2)"];
  const hue = (Math.log2(v)*36)%360;
  return [`hsla(${hue},90%,55%,.95)`,`hsla(${hue},90%,75%,.95)`];
};

function render(popIndex=-1){
  boardEl.innerHTML="";
  for(let i=0;i<16;i++){
    const cell=document.createElement('div');
    cell.className="cell";
    const v=grid[i];
    const tile=document.createElement('div');
    tile.className="tile"+(i===popIndex?" pop":"");
    const [bg,glow]=colors(v);
    tile.style.background = v ? `linear-gradient(135deg, ${bg}, ${glow})` : "rgba(0,0,0,.25)";
    tile.style.color = v>=128 ? "#031018" : "#111";
    tile.style.boxShadow = v ? `0 0 18px ${bg}` : "none";
    tile.textContent = v ? v : "";
    cell.appendChild(tile);
    boardEl.appendChild(cell);
  }
  document.getElementById('score').textContent=score;
  if(score>best){ best=score; localStorage.setItem("zy_best", String(best)); document.getElementById('best').textContent=best; }
}

function emptyCells(){
  const arr=[];
  for(let i=0;i<16;i++) if(!grid[i]) arr.push(i);
  return arr;
}
function addTile(){
  const empties=emptyCells();
  if(!empties.length) return;
  const idx=empties[Math.floor(Math.random()*empties.length)];
  grid[idx]=Math.random()<0.9?2:4;
  tone(520,0.03,"square",0.03);
  render(idx);
}

function slide(line){
  const arr=line.filter(x=>x);
  for(let i=0;i<arr.length-1;i++){
    if(arr[i]===arr[i+1]){
      arr[i]*=2; score+=arr[i];
      tone(880,0.04); setTimeout(()=>tone(1180,0.04),55);
      arr[i+1]=0;
    }
  }
  return arr.filter(x=>x);
}

function move(dir){
  const before=grid.slice();
  function get(r,c){ return grid[r*4+c]; }
  function set(r,c,v){ grid[r*4+c]=v; }

  for(let i=0;i<4;i++){
    let line=[];
    if(dir==="L") for(let c=0;c<4;c++) line.push(get(i,c));
    if(dir==="R") for(let c=3;c>=0;c--) line.push(get(i,c));
    if(dir==="U") for(let r=0;r<4;r++) line.push(get(r,i));
    if(dir==="D") for(let r=3;r>=0;r--) line.push(get(r,i));

    const sl=slide(line);
    while(sl.length<4) sl.push(0);

    if(dir==="L") for(let c=0;c<4;c++) set(i,c,sl[c]);
    if(dir==="R") for(let c=3;c>=0;c--) set(i,3-c,sl[c]);
    if(dir==="U") for(let r=0;r<4;r++) set(r,i,sl[r]);
    if(dir==="D") for(let r=3;r>=0;r--) set(3-r,i,sl[r]);
  }

  const changed = before.some((v,i)=>v!==grid[i]);
  if(changed){
    tone(620,0.02);
    render();
    addTile();
    if(checkWin()) { tone(1400,0.08); alert("ðŸŽ‰ VocÃª chegou no 2048!"); }
    if(checkLose()) { tone(180,0.14,"sawtooth",0.09); alert("Sem movimentos!"); }
  } else {
    tone(240,0.03,"sine",0.03);
  }
}

function checkWin(){ return grid.some(v=>v>=2048); }
function checkLose(){
  if(emptyCells().length) return false;
  for(let r=0;r<4;r++) for(let c=0;c<4;c++){
    const v=grid[r*4+c];
    if(c<3 && v===grid[r*4+c+1]) return false;
    if(r<3 && v===grid[(r+1)*4+c]) return false;
  }
  return true;
}

document.addEventListener('keydown',e=>{
  if(e.key==="ArrowLeft") move("L");
  if(e.key==="ArrowRight") move("R");
  if(e.key==="ArrowUp") move("U");
  if(e.key==="ArrowDown") move("D");
});

let sx=0,sy=0;
document.addEventListener('touchstart',e=>{sx=e.touches[0].clientX; sy=e.touches[0].clientY;},{passive:true});
document.addEventListener('touchend',e=>{
  const dx=(e.changedTouches[0].clientX-sx), dy=(e.changedTouches[0].clientY-sy);
  if(Math.abs(dx)>Math.abs(dy)){ if(dx>30) move("R"); else if(dx<-30) move("L"); }
  else { if(dy>30) move("D"); else if(dy<-30) move("U"); }
},{passive:true});

document.getElementById('newBtn').onclick=()=>{
  grid.fill(0); score=0; render(); addTile(); addTile();
};

render(); addTile(); addTile();
</script>
</body></html>
