<!DOCTYPE html><html lang="pt-br"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ZYPLAY â€¢ Travessia Neon</title>
<style>
  :root{--bg:#050510;--pink:#ff007a;--blue:#00d4ff;--gold:#ffcc00;}
  body{margin:0;background:radial-gradient(900px 500px at 20% -10%, rgba(255,0,122,.16), transparent 60%),
                 radial-gradient(900px 600px at 80% 0%, rgba(0,212,255,.18), transparent 60%), #050510;
       color:#fff;font-family:system-ui,Arial;text-align:center}
  header{display:flex;gap:10px;justify-content:center;align-items:center;padding:14px;background:rgba(18,18,43,.85);
         border-bottom:3px solid var(--pink);backdrop-filter:blur(10px)}
  a.btn,button.btn{padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.15);background:rgba(0,0,0,.25);
                   color:#fff;cursor:pointer;text-decoration:none;font-weight:800}
  a.btn:hover,button.btn:hover{border-color:rgba(0,212,255,.6)}
  canvas{display:block;margin:12px auto;border-radius:16px;border:2px solid rgba(0,212,255,.45);
         box-shadow:0 0 40px rgba(0,212,255,.12),0 0 50px rgba(255,0,122,.08)}
  .hud{max-width:720px;margin:10px auto;display:flex;gap:10px;justify-content:space-between;flex-wrap:wrap;padding:0 12px;font-weight:900}
  .pill{flex:1;min-width:160px;padding:10px 12px;border:1px solid rgba(255,255,255,.12);border-radius:999px;background:rgba(0,0,0,.22)}
  .tip{opacity:.85;font-size:13px}
</style></head><body>
<header>
  <a class="btn" href="/">â¬… Voltar ao menu</a>
  <button class="btn" id="soundBtn">ðŸ”Š Som: ON</button>
  <button class="btn" id="resetBtn">â†» Reiniciar</button>
</header>

<div class="hud">
  <div class="pill">Fase: <span id="lvl">1</span></div>
  <div class="pill">Vidas: <span id="life">3</span></div>
  <div class="pill">Pontos: <span id="score">0</span></div>
</div>
<div class="tip">Setas movem (um passo por vez). Chegue no topo sem bater.</div>
<canvas id="c" width="520" height="520"></canvas>

<script>
/* ===== SOM ===== */
let audioCtx=null, soundOn=true;
const soundBtn=document.getElementById('soundBtn');
function initAudio(){ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); }
function tone(f=440,d=0.06,type="square",vol=0.05){
  if(!soundOn) return; initAudio();
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.type=type; o.frequency.value=f; g.gain.value=vol;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+d);
}
soundBtn.onclick=()=>{ soundOn=!soundOn; tone(700,0.05); soundBtn.textContent=soundOn?"ðŸ”Š Som: ON":"ðŸ”‡ Som: OFF"; };
document.addEventListener("click", initAudio, {once:true});
document.addEventListener("keydown", initAudio, {once:true});

/* ===== JOGO ===== */
const canvas=document.getElementById('c'), ctx=canvas.getContext('2d');
const W=canvas.width, H=canvas.height;
const cell=40, cols=W/cell, rows=H/cell;

let lvl=1, life=3, score=0;
let player, cars=[];
function hud(){
  document.getElementById('lvl').textContent=lvl;
  document.getElementById('life').textContent=life;
  document.getElementById('score').textContent=score;
}

function resetLevel(){
  player={c:Math.floor(cols/2), r:rows-1};
  cars=[];
  const lanes=[9,8,7,5,4,3]; // linhas de trÃ¢nsito (de baixo p/ cima)
  lanes.forEach((r,i)=>{
    const speed=(1.2+lvl*0.25) * (i%2?1:-1);
    for(let k=0;k<3;k++){
      cars.push({x:Math.random()*W, y:r*cell+10, w:60, h:20, vx:speed});
    }
  });
  hud();
}

function step(){
  // update
  for(const car of cars){
    car.x += car.vx*2.2;
    if(car.vx>0 && car.x>W+80) car.x=-80;
    if(car.vx<0 && car.x<-80) car.x=W+80;
    // colisÃ£o
    const px=player.c*cell+10, py=player.r*cell+10;
    if(px<car.x+car.w && px+20>car.x && py<car.y+car.h && py+20>car.y){
      life--; tone(180,0.12,"sawtooth",0.09);
      if(life<=0){
        setTimeout(()=>alert("Game Over! Pontos: "+score),80);
        lvl=1; life=3; score=0;
      }
      resetLevel();
      break;
    }
  }

  // win
  if(player.r===0){
    score += 100*lvl;
    tone(980,0.06); setTimeout(()=>tone(1180,0.06),70); setTimeout(()=>tone(1400,0.08),140);
    lvl++;
    resetLevel();
  }

  // render
  ctx.clearRect(0,0,W,H);

  // fundo (rua)
  for(let r=0;r<rows;r++){
    ctx.fillStyle = (r===0) ? "rgba(0,212,255,.10)" : (r%2?"rgba(0,0,0,.25)":"rgba(18,18,43,.35)");
    ctx.fillRect(0,r*cell,W,cell);
  }
  // linhas
  ctx.strokeStyle="rgba(255,255,255,.08)";
  for(let r=0;r<=rows;r++){ ctx.beginPath(); ctx.moveTo(0,r*cell); ctx.lineTo(W,r*cell); ctx.stroke(); }

  // carros
  for(const car of cars){
    ctx.fillStyle="rgba(255,0,122,.95)";
    ctx.shadowColor="rgba(255,0,122,.6)"; ctx.shadowBlur=12;
    ctx.fillRect(car.x,car.y,car.w,car.h);
    ctx.shadowBlur=0;
    ctx.fillStyle="rgba(255,204,0,.9)";
    ctx.fillRect(car.x+8,car.y+4,10,12);
    ctx.fillRect(car.x+car.w-18,car.y+4,10,12);
  }

  // player
  const px=player.c*cell+10, py=player.r*cell+10;
  ctx.fillStyle="rgba(0,212,255,.95)";
  ctx.shadowColor="rgba(0,212,255,.7)"; ctx.shadowBlur=16;
  ctx.fillRect(px,py,20,20);
  ctx.shadowBlur=0;

  requestAnimationFrame(step);
}

let lock=false;
document.addEventListener('keydown',e=>{
  if(lock) return;
  const key=e.key;
  let moved=false;
  if(key==="ArrowUp" && player.r>0){ player.r--; moved=true; }
  if(key==="ArrowDown" && player.r<rows-1){ player.r++; moved=true; }
  if(key==="ArrowLeft" && player.c>0){ player.c--; moved=true; }
  if(key==="ArrowRight" && player.c<cols-1){ player.c++; moved=true; }
  if(moved){
    tone(520,0.03,"square",0.03);
    lock=true; setTimeout(()=>lock=false,70);
  }
});

document.getElementById('resetBtn').onclick=()=>{ lvl=1; life=3; score=0; resetLevel(); };

resetLevel(); step();
</script>
</body></html>
